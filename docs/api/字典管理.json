{
  "openapi": "3.0.3",
  "info": {
    "title": "字典管理 API",
    "description": "Laravel Dictionary 字典管理系统，支持字典分类和字典项的统一管理，提供完整的 CRUD 接口",
    "version": "1.0.0"
  },
  "servers": [
    {
      "url": "{protocol}://{host}/api/dictionaries",
      "description": "字典管理 API 服务器",
      "variables": {
        "protocol": {
          "default": "http",
          "enum": ["http", "https"],
          "description": "协议"
        },
        "host": {
          "default": "localhost",
          "description": "服务器地址"
        }
      }
    }
  ],
  "paths": {
    "/tree": {
      "get": {
        "tags": ["Dictionary"],
        "summary": "获取字典分类树",
        "description": "获取完整的字典分类树形结构，包含所有层级的分类信息\n\n**测试用例：**\n1. 获取完整树形结构\n2. 验证树形层级关系\n3. 验证节点数据完整性",
        "operationId": "getTree",
        "security": [{ "bearerAuth": [] }],
        "parameters": [
          {
            "name": "Accept",
            "in": "header",
            "required": true,
            "schema": { "type": "string" },
            "example": "application/json"
          }
        ],
        "responses": {
          "200": {
            "description": "成功",
            "content": {
              "application/json": {
                "example": {
                  "code": 200,
                  "msg": "获取成功",
                  "data": {
                    "list": [
                      {
                        "id": 1,
                        "key": "status",
                        "label": "状态分类",
                        "children": [
                          {
                            "id": 2,
                            "key": "user_status",
                            "label": "用户状态"
                          }
                        ]
                      }
                    ]
                  }
                }
              }
            }
          },
          "401": { "$ref": "#/components/responses/Unauthorized" }
        }
      }
    },
    "/categories": {
      "get": {
        "tags": ["Dictionary"],
        "summary": "获取字典分类列表",
        "description": "分页获取字典分类列表，支持按父分类筛选和排序\n\n**测试用例：**\n1. 默认分页查询（每页15条）\n2. 按父分类ID筛选\n3. 自定义每页数量查询\n4. 获取根分类（parent_id为空）",
        "operationId": "getCategories",
        "security": [{ "bearerAuth": [] }],
        "parameters": [
          {
            "name": "Accept",
            "in": "header",
            "required": true,
            "schema": { "type": "string" },
            "example": "application/json"
          },
          {
            "name": "parent_id",
            "in": "query",
            "description": "父分类ID",
            "schema": { "type": "integer" }
          },
          {
            "name": "page",
            "in": "query",
            "description": "页码",
            "schema": { "type": "integer", "default": 1 }
          },
          {
            "name": "per_page",
            "in": "query",
            "description": "每页数量",
            "schema": { "type": "integer", "default": 15, "minimum": 1, "maximum": 100 }
          }
        ],
        "responses": {
          "200": {
            "description": "成功",
            "content": {
              "application/json": {
                "example": {
                  "code": 200,
                  "msg": "获取成功",
                  "data": {
                    "list": [
                      {
                        "id": 1,
                        "parent_id": null,
                        "category_key": "status",
                        "category_name": "状态分类",
                        "sort_order": 1,
                        "created_at": "2025-01-17T00:00:00.000Z",
                        "updated_at": "2025-01-17T00:00:00.000Z"
                      }
                    ],
                    "total": 1,
                    "current_page": 1,
                    "per_page": 15
                  }
                }
              }
            }
          },
          "401": { "$ref": "#/components/responses/Unauthorized" }
        }
      },
      "post": {
        "tags": ["Dictionary"],
        "summary": "创建字典分类",
        "description": "创建新的字典分类，支持创建根分类和子分类\n\n**测试用例：**\n1. 创建根分类\n2. 创建子分类",
        "operationId": "createCategory",
        "security": [{ "bearerAuth": [] }],
        "parameters": [
          {
            "name": "Accept",
            "in": "header",
            "required": true,
            "schema": { "type": "string" },
            "example": "application/json"
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "examples": {
                "根分类": {
                  "summary": "创建根分类",
                  "value": {
                    "parent_id": null,
                    "category_key": "status",
                    "category_name": "状态分类",
                    "sort_order": 1
                  }
                },
                "子分类": {
                  "summary": "创建子分类",
                  "value": {
                    "parent_id": 1,
                    "category_key": "user_status",
                    "category_name": "用户状态",
                    "sort_order": 1
                  }
                }
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "创建成功",
            "content": {
              "application/json": {
                "example": {
                  "code": 200,
                  "msg": "创建成功",
                  "data": {
                    "id": 1,
                    "parent_id": null,
                    "category_key": "status",
                    "category_name": "状态分类",
                    "sort_order": 1,
                    "created_at": "2025-01-17T00:00:00.000Z",
                    "updated_at": "2025-01-17T00:00:00.000Z"
                  }
                }
              }
            }
          },
          "422": { "$ref": "#/components/responses/ValidationError" },
          "401": { "$ref": "#/components/responses/Unauthorized" }
        }
      }
    },
    "/categories/{id}": {
      "put": {
        "tags": ["Dictionary"],
        "summary": "更新字典分类",
        "description": "更新指定的字典分类信息\n\n**测试用例：**\n1. 更新分类名称\n2. 更新排序值\n3. 更新父分类",
        "operationId": "updateCategory",
        "security": [{ "bearerAuth": [] }],
        "parameters": [
          {
            "name": "Accept",
            "in": "header",
            "required": true,
            "schema": { "type": "string" },
            "example": "application/json"
          },
          {
            "name": "id",
            "in": "path",
            "required": true,
            "description": "分类ID",
            "schema": { "type": "integer" }
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "examples": {
                "更新名称": {
                  "summary": "更新分类名称",
                  "value": {
                    "category_name": "新的状态分类"
                  }
                },
                "更新排序": {
                  "summary": "更新排序值",
                  "value": {
                    "sort_order": 10
                  }
                }
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "更新成功",
            "content": {
              "application/json": {
                "example": {
                  "code": 200,
                  "msg": "更新成功",
                  "data": {
                    "id": 1,
                    "parent_id": null,
                    "category_key": "status",
                    "category_name": "新的状态分类",
                    "sort_order": 1,
                    "created_at": "2025-01-17T00:00:00.000Z",
                    "updated_at": "2025-01-17T00:00:00.000Z"
                  }
                }
              }
            }
          },
          "404": { "$ref": "#/components/responses/NotFound" },
          "422": { "$ref": "#/components/responses/ValidationError" },
          "401": { "$ref": "#/components/responses/Unauthorized" }
        }
      },
      "delete": {
        "tags": ["Dictionary"],
        "summary": "删除字典分类",
        "description": "删除指定的字典分类",
        "operationId": "deleteCategory",
        "security": [{ "bearerAuth": [] }],
        "parameters": [
          {
            "name": "Accept",
            "in": "header",
            "required": true,
            "schema": { "type": "string" },
            "example": "application/json"
          },
          {
            "name": "id",
            "in": "path",
            "required": true,
            "description": "分类ID",
            "schema": { "type": "integer" }
          }
        ],
        "responses": {
          "200": {
            "description": "删除成功",
            "content": {
              "application/json": {
                "example": {
                  "code": 200,
                  "msg": "删除成功",
                  "data": null
                }
              }
            }
          },
          "404": { "$ref": "#/components/responses/NotFound" },
          "401": { "$ref": "#/components/responses/Unauthorized" }
        }
      }
    },
    "/items": {
      "get": {
        "tags": ["Dictionary"],
        "summary": "获取字典项列表",
        "description": "分页获取字典项列表，支持按父分类键筛选和排序\n\n**测试用例：**\n1. 默认分页查询（每页15条）\n2. 按父分类键筛选\n3. 自定义每页数量查询\n4. 获取启用状态的字典项",
        "operationId": "getItems",
        "security": [{ "bearerAuth": [] }],
        "parameters": [
          {
            "name": "Accept",
            "in": "header",
            "required": true,
            "schema": { "type": "string" },
            "example": "application/json"
          },
          {
            "name": "parent_key",
            "in": "query",
            "description": "父分类键",
            "schema": { "type": "string" }
          },
          {
            "name": "page",
            "in": "query",
            "description": "页码",
            "schema": { "type": "integer", "default": 1 }
          },
          {
            "name": "per_page",
            "in": "query",
            "description": "每页数量",
            "schema": { "type": "integer", "default": 15, "minimum": 1, "maximum": 100 }
          }
        ],
        "responses": {
          "200": {
            "description": "成功",
            "content": {
              "application/json": {
                "example": {
                  "code": 200,
                  "msg": "获取成功",
                  "data": {
                    "list": [
                      {
                        "id": 1,
                        "parent_key": "status",
                        "item_key": "active",
                        "item_value": "激活",
                        "sort_order": 1,
                        "is_enabled": true,
                        "is_enabled_text": "启用",
                        "created_at": "2025-01-17T00:00:00.000Z",
                        "updated_at": "2025-01-17T00:00:00.000Z"
                      }
                    ],
                    "total": 1,
                    "current_page": 1,
                    "per_page": 15
                  }
                }
              }
            }
          },
          "401": { "$ref": "#/components/responses/Unauthorized" }
        }
      },
      "post": {
        "tags": ["Dictionary"],
        "summary": "创建字典项",
        "description": "创建新的字典项\n\n**测试用例：**\n1. 创建启用状态的字典项\n2. 创建禁用状态的字典项",
        "operationId": "createItem",
        "security": [{ "bearerAuth": [] }],
        "parameters": [
          {
            "name": "Accept",
            "in": "header",
            "required": true,
            "schema": { "type": "string" },
            "example": "application/json"
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "examples": {
                "启用状态": {
                  "summary": "创建启用状态的字典项",
                  "value": {
                    "parent_key": "status",
                    "item_key": "active",
                    "item_value": "激活",
                    "sort_order": 1,
                    "is_enabled": true
                  }
                },
                "禁用状态": {
                  "summary": "创建禁用状态的字典项",
                  "value": {
                    "parent_key": "status",
                    "item_key": "inactive",
                    "item_value": "未激活",
                    "sort_order": 2,
                    "is_enabled": false
                  }
                }
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "创建成功",
            "content": {
              "application/json": {
                "example": {
                  "code": 200,
                  "msg": "创建成功",
                  "data": {
                    "id": 1,
                    "parent_key": "status",
                    "item_key": "active",
                    "item_value": "激活",
                    "sort_order": 1,
                    "is_enabled": true,
                    "is_enabled_text": "启用",
                    "created_at": "2025-01-17T00:00:00.000Z",
                    "updated_at": "2025-01-17T00:00:00.000Z"
                  }
                }
              }
            }
          },
          "422": { "$ref": "#/components/responses/ValidationError" },
          "401": { "$ref": "#/components/responses/Unauthorized" }
        }
      }
    },
    "/items/{id}": {
      "put": {
        "tags": ["Dictionary"],
        "summary": "更新字典项",
        "description": "更新指定的字典项信息\n\n**测试用例：**\n1. 更新字典项值\n2. 更新启用状态\n3. 更新排序值",
        "operationId": "updateItem",
        "security": [{ "bearerAuth": [] }],
        "parameters": [
          {
            "name": "Accept",
            "in": "header",
            "required": true,
            "schema": { "type": "string" },
            "example": "application/json"
          },
          {
            "name": "id",
            "in": "path",
            "required": true,
            "description": "字典项ID",
            "schema": { "type": "integer" }
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "examples": {
                "更新值": {
                  "summary": "更新字典项值",
                  "value": {
                    "item_value": "已激活"
                  }
                },
                "更新状态": {
                  "summary": "更新启用状态",
                  "value": {
                    "is_enabled": false
                  }
                }
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "更新成功",
            "content": {
              "application/json": {
                "example": {
                  "code": 200,
                  "msg": "更新成功",
                  "data": {
                    "id": 1,
                    "parent_key": "status",
                    "item_key": "active",
                    "item_value": "已激活",
                    "sort_order": 1,
                    "is_enabled": true,
                    "is_enabled_text": "启用",
                    "created_at": "2025-01-17T00:00:00.000Z",
                    "updated_at": "2025-01-17T00:00:00.000Z"
                  }
                }
              }
            }
          },
          "404": { "$ref": "#/components/responses/NotFound" },
          "422": { "$ref": "#/components/responses/ValidationError" },
          "401": { "$ref": "#/components/responses/Unauthorized" }
        }
      },
      "delete": {
        "tags": ["Dictionary"],
        "summary": "删除字典项",
        "description": "删除指定的字典项",
        "operationId": "deleteItem",
        "security": [{ "bearerAuth": [] }],
        "parameters": [
          {
            "name": "Accept",
            "in": "header",
            "required": true,
            "schema": { "type": "string" },
            "example": "application/json"
          },
          {
            "name": "id",
            "in": "path",
            "required": true,
            "description": "字典项ID",
            "schema": { "type": "integer" }
          }
        ],
        "responses": {
          "200": {
            "description": "删除成功",
            "content": {
              "application/json": {
                "example": {
                  "code": 200,
                  "msg": "删除成功",
                  "data": null
                }
              }
            }
          },
          "404": { "$ref": "#/components/responses/NotFound" },
          "401": { "$ref": "#/components/responses/Unauthorized" }
        }
      }
    },
    "/items/by-key/{categoryKey}": {
      "get": {
        "tags": ["Dictionary"],
        "summary": "根据分类键获取字典项",
        "description": "根据分类键获取该分类下所有启用状态的字典项，按排序值升序排列\n\n**测试用例：**\n1. 获取指定分类的字典项\n2. 获取空分类的字典项\n3. 获取不存在的分类（返回空列表）",
        "operationId": "getItemsByKey",
        "security": [{ "bearerAuth": [] }],
        "parameters": [
          {
            "name": "Accept",
            "in": "header",
            "required": true,
            "schema": { "type": "string" },
            "example": "application/json"
          },
          {
            "name": "categoryKey",
            "in": "path",
            "required": true,
            "description": "分类键",
            "schema": { "type": "string" }
          }
        ],
        "responses": {
          "200": {
            "description": "成功",
            "content": {
              "application/json": {
                "example": {
                  "code": 200,
                  "msg": "获取成功",
                  "data": {
                    "list": [
                      {
                        "id": 1,
                        "parent_key": "status",
                        "item_key": "active",
                        "item_value": "激活",
                        "sort_order": 1,
                        "is_enabled": true,
                        "is_enabled_text": "启用",
                        "created_at": "2025-01-17T00:00:00.000Z",
                        "updated_at": "2025-01-17T00:00:00.000Z"
                      },
                      {
                        "id": 2,
                        "parent_key": "status",
                        "item_key": "inactive",
                        "item_value": "未激活",
                        "sort_order": 2,
                        "is_enabled": true,
                        "is_enabled_text": "启用",
                        "created_at": "2025-01-17T00:00:00.000Z",
                        "updated_at": "2025-01-17T00:00:00.000Z"
                      }
                    ]
                  }
                }
              }
            }
          },
          "401": { "$ref": "#/components/responses/Unauthorized" }
        }
      }
    }
  },
  "components": {
    "securitySchemes": {
      "bearerAuth": {
        "type": "http",
        "scheme": "bearer",
        "bearerFormat": "Token"
      }
    },
    "schemas": {
      "DictionaryCategory": {
        "type": "object",
        "properties": {
          "id": {
            "type": "integer",
            "description": "分类ID"
          },
          "parent_id": {
            "type": "integer",
            "nullable": true,
            "description": "父分类ID"
          },
          "category_key": {
            "type": "string",
            "maxLength": 100,
            "description": "分类键（唯一）"
          },
          "category_name": {
            "type": "string",
            "maxLength": 200,
            "description": "分类名称"
          },
          "sort_order": {
            "type": "integer",
            "minimum": 0,
            "description": "排序值"
          },
          "created_at": {
            "type": "string",
            "format": "date-time",
            "description": "创建时间"
          },
          "updated_at": {
            "type": "string",
            "format": "date-time",
            "description": "更新时间"
          }
        }
      },
      "DictionaryItem": {
        "type": "object",
        "properties": {
          "id": {
            "type": "integer",
            "description": "字典项ID"
          },
          "parent_key": {
            "type": "string",
            "maxLength": 100,
            "description": "所属分类键"
          },
          "item_key": {
            "type": "string",
            "maxLength": 100,
            "description": "字典项键"
          },
          "item_value": {
            "type": "string",
            "maxLength": 200,
            "description": "字典项值"
          },
          "sort_order": {
            "type": "integer",
            "minimum": 0,
            "description": "排序值"
          },
          "is_enabled": {
            "type": "boolean",
            "description": "是否启用：true-启用, false-禁用"
          },
          "is_enabled_text": {
            "type": "string",
            "description": "启用状态文本"
          },
          "created_at": {
            "type": "string",
            "format": "date-time",
            "description": "创建时间"
          },
          "updated_at": {
            "type": "string",
            "format": "date-time",
            "description": "更新时间"
          }
        }
      },
      "TreeNode": {
        "type": "object",
        "properties": {
          "id": {
            "type": "integer",
            "description": "节点ID"
          },
          "key": {
            "type": "string",
            "description": "节点键"
          },
          "label": {
            "type": "string",
            "description": "节点标签"
          },
          "children": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/TreeNode"
            },
            "description": "子节点"
          }
        }
      }
    },
    "responses": {
      "BadRequest": {
        "description": "参数错误",
        "content": {
          "application/json": {
            "example": {
              "code": 400,
              "msg": "参数错误",
              "data": null
            }
          }
        }
      },
      "Unauthorized": {
        "description": "未授权",
        "content": {
          "application/json": {
            "example": {
              "code": 401,
              "msg": "未授权访问",
              "data": null
            }
          }
        }
      },
      "NotFound": {
        "description": "资源不存在",
        "content": {
          "application/json": {
            "example": {
              "code": 404,
              "msg": "资源不存在",
              "data": null
            }
          }
        }
      },
      "ValidationError": {
        "description": "数据校验失败",
        "content": {
          "application/json": {
            "example": {
              "code": 422,
              "msg": "数据校验失败",
              "data": {
                "errors": {
                  "category_key": ["分类Key不能为空"],
                  "category_name": ["分类名称不能为空"]
                }
              }
            }
          }
        }
      }
    }
  }
}
